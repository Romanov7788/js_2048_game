!function(){var e,t,r={};function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}var n=function(){var e;function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),this.board=e||this.createEmptyBoard(),this.score=0,this.status=t.gameStatuses.idle}return e=[{key:"saveBoardState",value:function(){return JSON.parse(JSON.stringify(this.board))}},{key:"hasBoardChanged",value:function(e,t){for(var r=0;r<e.length;r++)for(var a=0;a<e[r].length;a++)if(e[r][a]!==t[r][a])return!0;return!1}},{key:"addCells",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=0;t<e;t++)this.addRandomTitle()}},{key:"initializeGame",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.board=this.createEmptyBoard(),this.score=0,this.addCells(2),this.updateScoreDisplay(),this.showMessage(e)}},{key:"updateScoreDisplay",value:function(){var e=document.querySelector(".game-score");e&&(e.textContent=this.score)}},{key:"createEmptyBoard",value:function(){return[,,,,].fill(null).map(function(){return[,,,,].fill(0)})}},{key:"updateBoardDisplay",value:function(){var e=this.board;document.querySelectorAll(".field-cell").forEach(function(t,r){var a=Math.floor(r/4),n=r%4;t.textContent=0===e[a][n]?"":e[a][n],t.className="field-cell",0!==e[a][n]&&t.classList.add("tile-".concat(e[a][n]))})}},{key:"addRandomTitle",value:function(){for(var e=[],t=0;t<4;t++)for(var r=0;r<4;r++)0===this.board[t][r]&&e.push([t,r]);if(0!==e.length){var n,o=function(e){if(Array.isArray(e))return e}(n=e[Math.floor(Math.random()*e.length)])||function(e,t){var r,a,n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),2!==o.length);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw a}}return o}}(n,2)||function(e,t){if(e){if("string"==typeof e)return a(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,2)}}(n,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=o[0],s=o[1];this.board[i][s]=.9>Math.random()?2:4,this.updateBoardDisplay()}}},{key:"moveLeft",value:function(){for(var e=this.board,t=this.saveBoardState(),r=Array.from({length:4},function(){return[,,,,].fill(0)}),a=0,n=0;n<4;n++)for(var o=0,i=0;i<4;i++)0!==e[n][i]&&(r[n][o]===e[n][i]?(r[n][o]*=2,a+=r[n][o],o++):(0===r[n][o]||o++,r[n][o]=e[n][i]));return this.score+=a,this.board=r,this.hasBoardChanged(t,this.board)&&this.addRandomTitle(),this.updateBoardDisplay(),this.updateScoreDisplay(),this.score}},{key:"moveRight",value:function(){for(var e=this.board,t=this.saveBoardState(),r=Array.from({length:4},function(){return[,,,,].fill(0)}),a=0,n=0;n<4;n++)for(var o=3,i=3;i>=0;i--)0!==e[n][i]&&(r[n][o]===e[n][i]?(r[n][o]*=2,a+=r[n][o],o--):(0===r[n][o]||o--,r[n][o]=e[n][i]));return this.score+=a,this.board=r,this.hasBoardChanged(t,this.board)&&this.addRandomTitle(),this.updateScoreDisplay(),this.score}},{key:"moveUp",value:function(){for(var e=this.board,t=this.saveBoardState(),r=Array.from({length:4},function(){return[,,,,].fill(0)}),a=0,n=0;n<4;n++)for(var o=0,i=0;i<4;i++)0!==e[i][n]&&(r[o][n]===e[i][n]?(r[o][n]*=2,a+=r[o][n],o++):0===r[o][n]?r[o][n]=e[i][n]:r[++o][n]=e[i][n]);return this.score+=a,this.board=r,this.hasBoardChanged(t,this.board)&&this.addRandomTitle(),this.updateScoreDisplay(),this.score}},{key:"moveDown",value:function(){for(var e=this.board,t=this.saveBoardState(),r=Array.from({length:4},function(){return[,,,,].fill(0)}),a=0,n=0;n<4;n++)for(var o=3,i=3;i>=0;i--)0!==e[i][n]&&(r[o][n]===e[i][n]?(r[o][n]*=2,a+=r[o][n],o--):0===r[o][n]?r[o][n]=e[i][n]:r[--o][n]=e[i][n]);return this.score+=a,this.board=r,this.hasBoardChanged(t,this.board)&&this.addRandomTitle(),this.updateScoreDisplay(),this.score}},{key:"checkWin",value:function(){for(var e=0;e<4;e++)for(var r=0;r<4;r++)if(2048===this.board[e][r])return this.showMessage(t.gameStatuses.win),!0;return!1}},{key:"checkLose",value:function(){for(var e=0;e<4;e++)for(var r=0;r<4;r++)if(0===this.board[e][r])return!1;for(var a=0;a<4;a++)for(var n=0;n<4;n++)if(a<3&&this.board[a][n]===this.board[a+1][n]||n<3&&this.board[a][n]===this.board[a][n+1])return!1;return this.showMessage(t.gameStatuses.lose),!0}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){return this.checkWin()?t.gameStatuses.win:this.checkLose()?t.gameStatuses.lose:this.status}},{key:"start",value:function(){this.status=t.gameStatuses.playing,this.initializeGame("start")}},{key:"restart",value:function(){this.status=t.gameStatuses.idle,this.initializeGame("Game restarted")}},{key:"showMessage",value:function(e){var r=document.querySelector(".message-container");r&&(r.querySelector(".message-start").classList.add("hidden"),r.querySelector(".message-lose").classList.add("hidden"),r.querySelector(".message-win").classList.add("hidden")),e===t.gameStatuses.win?r.querySelector(".message-win").classList.remove("hidden"):e===t.gameStatuses.lose&&r.querySelector(".message-lose").classList.remove("hidden")}}],function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(t.prototype,e),t}();t={idle:"idle",playing:"playing",lose:"lose",win:"win"},(e="gameStatuses")in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t;var o=new(r=n),i=document.getElementById("startButton"),s=document.getElementById("restartButton");function l(){o.start(),document.querySelectorAll(".field-cell").forEach(function(e){e.textContent=""}),h(o.board),u(o.board),i.style.display="none",s.style.display="block"}function u(e){document.querySelectorAll(".field-cell").forEach(function(t,r){var a=e[Math.floor(r/4)][r%4];t.textContent=0===a?"":a}),c()}function c(){var e=o.getStatus();(e===r.gameStatuses.win||e===r.gameStatuses.lose)&&document.removeEventListener("keydown",d)}function d(e){var t={ArrowLeft:function(){return o.moveLeft()},ArrowRight:function(){return o.moveRight()},ArrowUp:function(){return o.moveUp()},ArrowDown:function(){return o.moveDown()}}[e.key];t&&(t(),o.checkWin()?c(r.gameStatuses.win):o.checkLose()&&c(r.gameStatuses.lose),h(o.board),u(o.board))}function h(e){document.querySelectorAll(".field-row").forEach(function(t,r){Array.from(t.children).forEach(function(t,a){var n=e[r][a];t.className="field-cell field-cell--"+n,t.innerText=n>0?n:""})})}document.addEventListener("keydown",d),s.style.display="none",i.addEventListener("click",function(){l()}),s.addEventListener("click",function(){o.restart(),l(),document.addEventListener("keydown",d)})}();
//# sourceMappingURL=index.85212c41.js.map
